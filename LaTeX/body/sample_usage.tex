%!TEX root = ../thesis_main_sample.tex

\chapter{テンプレート使用方法}
	\label{chp:readme}

	\section{ファイル構成}
		\label{sec:contents}

		本テンプレートは下記のような構成となっている。

		\begin{itemize}
			\ttfamily
			\item thesis\_guideline.pdf: この要綱のファイル
			\item \textbf{LaTeX/}
			\begin{itemize}
				\item thesis\_main.tex: このファイルに自分の論文を書く
				\item thesis\_main\_sample.tex: この要綱の tex ソースファイル（参考・\TeX{} 環境のテスト用）
				\item sample\_bibliography.bib: この要綱で用いたBibTeXによる参考文献リストファイル
				\item jecon\_custom.bst: BibTeX用の参考文献スタイルファイル
				\item latexmkrc: latexmkによる自動コンパイルの設定ファイル
				\item lllsdepp.sty: この要綱のスタイルファイル
				\item \textbf{figure/}: 画像ファイルの格納場所
					\begin{itemize}
						\item Lenna.png: サンプル画像（\cref{fig:sample}）
					\end{itemize}
				\item \textbf{body/}: 本文のtexソースを置く場所
					\begin{itemize}
						\item sample\_guideline.tex: \cref{chp:guideline} のソースファイル
						\item sample\_usage.tex: \cref{chp:readme}のソースファイル
					\end{itemize}
				\item \textbf{appendix/}: 付録のtexソースを置く場所
					\begin{itemize}
						\item sample\_appendix.tex
					\end{itemize}
			\end{itemize}
			\item \textbf{Office/}: Officeソフトウェア向けテンプレート集
				\begin{itemize}
					\item msword\_template-master.docx: Word\textsuperscript{\textregistered}を用いる場合はこのファイルに執筆（修士論文用）
					\item msword\_template-bachelor.docx: Word\textsuperscript{\textregistered}を用いる場合はこのファイルに執筆（卒業論文用）
					\item libreoffice\_template-master.docx: LibreOffice を用いる場合はこのファイルに執筆（修士論文用）
					\item libreoffice\_template-bachelor.docx: LibreOffice を用いる場合はこのファイルに執筆（卒業論文用）
				\end{itemize}
		\end{itemize}

		\noindent
		執筆に用いるソフトウェアに応じて、\LaTeX{} 版か Office 版を選択せよ。
		以下の節では、それぞれのフォーマットについて、その使い方を説明する。

	\section{LaTeX}
		\label{sec:latex}

		本テンプレートファイルは \texttt{TeXLive} の2016以降のバージョンに対応している。
		以下、使用するOSに応じた最新の \texttt{TeXLive} をインストールしている前提を置く。
		また、基本的な使用方法については理解しているものとする。

		本テンプレートは、\texttt{thesis\_main.tex}を論文の骨格の記述に用い、章ごとに分割された tex ソースファイルを本文(\texttt{body})と付録(\texttt{appendix})で区別して管理する構成となっている。

		\subsection{スタイルファイル}
			\label{sub:style_file}

			\texttt{lllsdepp.sty}が\cref{chp:guideline}で指定した体裁を再現する。
			すでに多数のマクロ・パッケージが読み込まれている状態であるが、執筆において使用したいマクロ・パッケージがある場合はこの\texttt{lllsdepp.sty}の該当箇所において直接宣言してほしい。
			\texttt{thesis\_main.tex}のプリアンブルで \texttt{\textbackslash usepackage}によるパッケージ読み込みは避けること。
			これは本テンプレートで使用している \texttt{creveref} というパッケージの制約により、\texttt{creveref}より後の行でのパッケージ読み込みが禁じられているためである。
			ただし、執筆において使用したいマクロ・パッケージの動作が、\texttt{lllsdepp.sty}にデフォルトで記述されているマクロ・パッケージの読み込み順を変更しないと保証されない場合は、この限りではない。


			% 両面印刷する場合はclassオプションからreportを外すと良い。
			% このときの左右余白やヘッダー・フッターのレイアウトは適宜変更して見やすくすること（デフォルトは汚い）。

		\subsection{メインファイル}
			\label{sub:メインファイル}

			\texttt{thesis\_main.tex}には、表紙に記入すべき情報と各章のtexソースの読み込み順を記述する。
			まず、8行目から次のような記述があるので、指示に従って執筆者自身の情報に書き換える
			\footnote{提出年度を自動化しないのは、当該年度以降に学位論文texソースをコンパイルしたときに提出年度が上書きされるのを嫌うため。}。

			\small
			\begin{verbatim}
				% ===== 執筆者記入事項 ここから =====
				\thesisNendo{201x}	% 提出年度
				\thesisClass% 所属　下記2行のうち当てはまる方をコメントイン
				% {教育学部}	% 卒業論文
				{教育学研究科}	% 修士論文
				\thesisAuthor{本郷　弥生}	% あなたのお名前（姓名は全角スペースで分ける）
				\thesisAuthorID{23-000000}	% あなたの学籍番号（半角）
				\thesisTitle{教育学研究科・教育学部学位論文執筆要綱}	% 論文題目
				% サブタイトルがなければ下の行をコメントアウト
				\thesisSubTitle{生涯学習基盤経営コース・教育実践政策学コース向け}	% サブタイトル（ダッシュなし）
				\thesisTeacher{浅野 柏子　教授}	% 姓[半角スペース]名[全角スペース]職階
				% ===== 執筆者記入事項 ここまで =====
			\end{verbatim}
			\normalsize

			各章のtexソースは、執筆者の章立てにおいて意図する順番に \texttt{\textbackslash include} コマンドで読み込む。
			章の入れ替えが楽になるほか、1つのファイルが大きくなりすぎてエディタで扱いづらくなることを防ぐ。

		\subsection{コンパイル}
			\label{sub:compile}

			本テンプレートを用いた文書は、\texttt{latexmk}を使った次のコマンドをシェル上で実行してコンパイルせよ。

			\begin{verbatim}
				$ latexmk -pvc thesis_main.tex
			\end{verbatim}

			\texttt{latexmk}は、\texttt{include/input}を用いて分散化されたtexソースの構成を追跡し、BibTeXないしMendexといった補助的に用いるコマンドを適切なタイミングで自動的に実行する\LaTeX 文書ビルドツールである。
			\texttt{pvc}オプションを与えることにより、texソースファイルの変更を逐一監視してくれるので、本文を通常通り保存するだけで種々のコンパイルが実行されるうえ、PDFビューワを開いて最新の状態を表示してくれるようになる。
			そのための設定ファイルが\texttt{latexmkrc}である。
			設定を適切に反映するために、上記のコマンドは \texttt{LaTeX/}フォルダ直下で実行すること。
			OSごとの実行コマンドの違いはこの\texttt{latexmkrc}が吸収しているので、執筆者は不具合のない限り \texttt{latexmkrc}の存在を意識する必要はない。

		\subsection{執筆}
			\label{sub:writing}

			実際の執筆において本テンプレートが推奨するコマンドを説明する。

			\subsubsection{強調}

				基本は \texttt{\textbackslash emph} を用いよ。
				これにより欧文では斜体、和文では太字が使われるようになる。
				本テンプレートのスタイルファイルでは \texttt{otf}パッケージの\texttt{bold}オプションを有効にしているため、太字はすべてゴシックになる。

			\subsubsection{引用}

				素の\LaTeX 文書においては\texttt{``\dots''}や\texttt{quote/quotation}環境が用いられるが、本テンプレートでは \texttt{csquotes} の使用を推奨している。
				スタイルファイルには既に導入されているので、inline と block それぞれで次のようにコマンドを使い分けるとよい。

				\begin{description}
					\item[Inline] 　\\
						\verb|\textcquote[<ページ番号;例: p. 19>]{<引用キー;例: sawada>}{...}|
					\item[Block] 　
						\begin{verbatim}
							\begin{displaycquote}[<ページ番号;例: p. 74>]{<引用キー;例: sawada>}
							    ...
							\end{displaycquote}
						\end{verbatim}
				\end{description}

				\noindent
				\texttt{text/display}と\texttt{quote}の前に一文字\texttt{c}が入っていることに注意。
				この\texttt{c}は\texttt{cite}を意味すると思うとよい。
				オプション引数（\texttt{[ ]}の中）の形でページ番号を指定すれば、自動的に引用文の後ろに参考文献情報が挿入される。

			\subsubsection{参照}

				ふつう、節や図表で付与した\verb|\label|を\verb|\ref|コマンドで参照するところ、本テンプレートでは\verb|\cref|を使うと記述が楽になる。
				この\verb|\cref|というコマンドは\texttt{cleveref}によって提供されるもので、\texttt{lllsdepp.sty}ではこれを日本語向けに設定してある。

				例えば、章番号を引用するときに通常の\verb|\ref|を用いた場合だと\verb|第\ref{chp:hoge}章|と入力しなければならないが、\texttt{cleveref}を使うと、\verb|\cref{chp:hoge}|だけで済むようになる。
				さらに\texttt{cleveref}は\verb|\label|の貼られた場所がどういう環境であるかを自動で識別し、そこが章や節であれば「第n章」、「n.m節」などと補完し、図表であれば「図n」「表m」と表示することができるので、あらゆるラベル参照を\texttt{cleveref}で代用することが出来る。


			\subsection{参考文献}
				\label{sub:bibtex}

				本テンプレートではpBibTeXを用いた参考文献処理が組み込まれている。
				したがって執筆者はBibTeX形式で参考文献リストを準備するのがよい。
				また、参考文献スタイルとしてSIST02\footurl{http://jipsti.jst.go.jp/sist/handbook/sist02_2007/main.htm}を採用している。経済学の標準的な形式を再現した \texttt{jecon}\footurl{http://shirotakeda.org/ja/tex-ja/jecon-ja.html}を元にいくつかのオプションを変更した\texttt{jecon\_custom.bst}を使用することでSIST02のサポートを実現しており、和書・洋書が混在した参考文献リストが見やすく出力されるようになっている。
				本テンプレートの\texttt{jecon\_custom.bst}は文献管理ソフトウェア \texttt{Mendeley} \footurl{https://www.mendeley.com}で出力できるBibTeX形式に準拠しており、とくに和文書籍・論文を \texttt{CiNII}\footurl{http://ci.nii.ac.jp}から \texttt{Mendeley} へとエクスポートしたときのBibTeXフォーマットにおいても著者の姓名が正しい順番に揃うように改変してある。

				したがって執筆者は \texttt{Mendeley} を用いた文献管理を行いつつ、そのデスクトップアプリケーションから出力したBibTeXファイル
				\footnote{詳しい方法は公式ドキュメントなどを参照されたい
				(\url{https://blog.mendeley.com/2011/10/25/howto-use-mendeley-to-create-citations-using-latex-and-bibtex/})。}
				を本テンプレートの\texttt{sample\_bibliography.bib}と同じ階層に置くことで、快適な参考文献処理が行えるのである。
				% TODO: should be update line number according to jecon_custom
				ただし、BibTeXファイルをその他の方法で独自に管理していて日本人著者の姓名が逆に表示される場合は、\verb|jecon_custom.bst|の168行目から始まるオプションを0に変更せよ。

	\section{Office}
		\label{sec:office}

		Officeソフトウェア向けにもテンプレートを用意した。
		対応しているソフトウェアは、Microsoft Office Word \textsuperscript{\textregistered} とLibreOffice \footurl{https://www.libreoffice.org} である。

		Word \textsuperscript{\textregistered} 版のテンプレートはファイル形式として \texttt{.doc}\textbf{x}を採用した。
		本テンプレートはOffice 2016以上のバージョンが推奨である。
		それ未満のバージョンにおけるテンプレートの動作不良は一切サポートしない。

		LibreOffice版はバージョン5.3.4で動作確認している。
		それ以上のバージョンであれば動作に大きな問題はないと考えられる。

		ただしOfficeテンプレートを使う場合は、\LaTeX{}版と違って以下の点が不便であることから、あまり推奨しない。
		執筆には\LaTeX{}版を使うことを強く推奨する。

		\begin{itemize}
			\item ソースコードのコメントに相当する機能がないので、たとえば2種類の文のどちらがいいか考えるときに不便
			\item \LaTeX{}では改行1つは無視されるので、たとえばソースコード1行に1文を割り当てると行の入れ替えがしやすくなるが、WYSIWYGなソフトではそう簡単にいかない
			\item 目次はボタンを手動で押すなどして、半自動更新せねばならない
			% \item WYSIWYGなので論理的な構成を意識しづらい\footnote{いま自分が「節」の中身を書いているのか「項」を書いているのか、はたまた「引用」をしているのか通常の本文なのか、という区別が見た目からわかりにくくなる。\LaTeX{}ではソースコードのコマンドからそれが識別できるので、文書の「論理構造」を意識しながら書ける。これが実は\LaTeX{}を使って論文を書くべき本当の理由かもしれない。}
			\item 章ごとの改ページを手作業で行わなければならない
			\item テキストファイルではないので、\texttt{git}などのバージョン管理システムを用いた編集履歴管理ができない
			\item 便利なテキストエディタを使えないので、非効率なGUIをポチポチと操作せねばならない
			\item 原稿を書きたいと思ってもソフトの立ち上げが遅く、その間に何を書きたかった忘れてしまいやすい
			\item Officeソフトウェアは長大なテキストの扱いが不安定で、論文が終盤に差し掛かるほどクラッシュしやすく、原稿が失われやすい
			\item 章ごとにファイルを分割して管理したくても、PDF出力・印刷は別々に行う必要があり、煩雑になる\footnote{逆に\LaTeX{}では章ごとのPDF出力がしにくく感じるかもしれないが、\texttt{docmute}というパッケージを使うと解決できる。}
			\item 本テンプレートの管理者はもっぱら\LaTeX{}を利用しているので、Office版の不具合対応が遅れやすい
			\item なぜかどんなに工夫しても\LaTeX{}で出力した論文より美しい組版を実現することができない
		\end{itemize}

		\subsection{表紙}
			\label{sub:titlepage_w}

			まず表紙に執筆者情報を記入する。
			記入すべき情報は修士論文か卒業論文かでそれぞれ異なるため、テンプレートファイルを正しく選ぶ。
			最初の行の\emph{提出年度}を入力し、次に\emph{論文題目}を記述する。
			名前、学籍番号、指導教員も忘れずに記入する。


		\subsection{執筆に有用な機能と注意点}
			\label{sub:writing_w}

			章の最後には必ず「改ページ」を挿入し、次の章が新しいページから始まるようにせよ。
			各種目次は手動で更新する必要があるので、章・節・項や図表を挿入したあとは「目次を更新」を実行するようにせよ。

			\subsection{スタイル}
				\label{sub:style_w}

				本文に適用するスタイルは、スタイル選択から適切なものを選ぶこと。
				「見出し1--3」が章・節・項に対応しているほか、ブロック引用のための「引用」スタイルを用意している。
				見出しのタイトルを入力したあと、そのタイトルを選択し、「見出し1--3」のいずれかを選ぶと、自動的にHarvard方式の番号が入力される。

			\paragraph{図表番号の付け方}

				[参照設定] タブの [図表番号] グループで、[図表番号の挿入] が可能だそうである。
				これにより、図表番号が自動で連番となる。

			\paragraph{先行研究リストの作り方}

				文献管理ソフトの\texttt{Mendeley}にはWord/LibreOffice向けに参考文献を自動生成する補助アプリが搭載されている。
				\texttt{CiNii}その他からインポートした論文・書籍を引用するときに使用するとよい。
